import{a as g,r as u,o as F,b as A,m as E,e as t,w as a,i as m,j as i,f as M,F as U,g as B,p as V}from"./entry.0077e48a.js";import{b as k,a as C,c as L,V as j}from"./VCard.1ab51dfd.js";import{V as R}from"./VDataTable.1a53a7aa.js";import{V as S}from"./VForm.0229d918.js";import{V as q}from"./VCheckboxBtn.d2c75b1a.js";import{V as $}from"./VTextarea.289edbfb.js";import{V as z}from"./VDialog.98a5580e.js";import{V as G}from"./VAlert.94bd42fc.js";import{V as I}from"./VSnackbar.c4c003b0.js";import"./createSimpleFunctional.0ef38bc9.js";import"./VAvatar.fa2cb2ba.js";import"./VSelect.1a9a2110.js";import"./forwardRefs.6ea3df5c.js";import"./VMenu.a2c145c5.js";import"./VDivider.51cc7cc8.js";const J=B("h1",{class:"mb-4"},"📋 미승인 교육 신청 내역",-1),x='형식은 "YYYYMMDD 이수완료"로 입력해주세요. ex)20250416 이수완료',ie=g({__name:"list",setup(K){const y=u([]),s=u([]),h=[{title:"교육코드",key:"eduCode"},{title:"교육명",key:"eduName"},{title:"직원코드",key:"empCode"},{title:"직원명",key:"empName"},{title:"부서코드",key:"deptCode"},{title:"부서명",key:"deptName"},{title:"교육 이수 내역",key:"eduHistory"},{title:"승인상태",key:"status"},{title:"년도",key:"searchYear"}],p=async()=>{const r=await V.get("http://localhost:8282/hr/edu/eduList");y.value=r.data.eduList},d=u(!1),l=u({eduCode:"",eduName:"",empCode:"",empName:"",deptCode:"",deptName:"",eduHistory:'형식은 "YYYYMMDD 이수완료"로 입력해주세요. ex)20250416 이수완료',searchYear:"",status:""}),n=u(!1),c=u("success"),v=u("success"),f=u("완료되었습니다."),Y=()=>{l.value.eduHistory===x&&(l.value.eduHistory="")},H=()=>{l.value.eduHistory.trim()||(l.value.eduHistory=x)},b=()=>{if(s.value.some(e=>e.status==="승인완료")){c.value="error",f.value="✅ 이미 승인완료된 항목입니다.",v.value="error",n.value=!0;return}if(s.value.length!==1){alert("수정은 하나만 선택해주세요!");return}l.value={...s.value[0]},l.value.eduHistory||(l.value.eduHistory='형식은 "YYYYMMDD 이수완료"로 입력해주세요. ex)20250416 이수완료'),d.value=!0,s.value=[]},w=async()=>{try{await V.post("http://localhost:8282/hr/edu/checkEduHistory",l.value),d.value=!1,await p()}catch(r){console.error("수정 실패:",r)}},N=async()=>{if(s.value.some(e=>e.status==="승인완료")){c.value="error",f.value="✅ 이미 승인완료된 항목입니다.",v.value="error",n.value=!0;return}for(const e of s.value){const{searchYear:o,eduCode:_,empCode:D,status:T}=e;await V.post("http://localhost:8282/hr/edu/delReqEdu",{searchYear:o,eduCode:_,empCode:D,status:T})}await p()};return F(()=>{p()}),(r,e)=>(A(),E(U,null,[J,t(C,null,{default:a(()=>[t(k,null,{default:a(()=>[t(m,{class:"mr-2",color:"primary",onClick:b},{default:a(()=>[i("수정")]),_:1}),t(m,{color:"error",onClick:N},{default:a(()=>[i("신청취소")]),_:1}),t(M(R),{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),headers:h,items:y.value,"item-value":"eduCode","show-select":"","return-object":"",class:"mt-4","items-per-page":10},null,8,["modelValue","items"])]),_:1})]),_:1}),t(z,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=o=>d.value=o),"max-width":"600"},{default:a(()=>[t(C,null,{default:a(()=>[t(L,null,{default:a(()=>[i("교육 신청 수정")]),_:1}),t(k,null,{default:a(()=>[t(S,null,{default:a(()=>[t(q,{label:"교육명",modelValue:l.value.eduName,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.eduName=o),class:"mb-4"},null,8,["modelValue"]),t($,{label:"교육 이수 내역",modelValue:l.value.eduHistory,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.eduHistory=o),onFocus:Y,onBlur:H},null,8,["modelValue"])]),_:1})]),_:1}),t(j,{class:"justify-end"},{default:a(()=>[t(m,{variant:"text",onClick:e[3]||(e[3]=o=>d.value=!1)},{default:a(()=>[i("취소")]),_:1}),t(m,{color:"primary",onClick:w},{default:a(()=>[i("저장")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(I,{modelValue:n.value,"onUpdate:modelValue":e[5]||(e[5]=o=>n.value=o),location:"top",timeout:3e3,color:c.value},{default:a(()=>[t(G,{density:"compact",type:v.value,title:"알림",text:f.value},null,8,["type","text"])]),_:1},8,["modelValue","color"])],64))}});export{ie as default};
