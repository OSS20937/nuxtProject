import{_ as z}from"./AppSelect.vue.07a85e6f.js";import{_ as Y}from"./AppTextField.vue.2fc85679.js";import{a as q,N as G,r as s,o as J,b as K,m as Q,e,w as a,j as r,i,f as X,g as Z,F as ee,p}from"./entry.1dfc0890.js";import{b as $}from"./index.dd6e2a2d.js";import{a as R}from"./index.5c05f772.js";import{u as E,w as te}from"./xlsx.f5126985.js";import{u as ae}from"./emp.1ff55ba3.js";import{V as le,a as oe}from"./VTabs.917385ff.js";import{a as c,b as k,V as se}from"./VCard.9d39ab92.js";import{V as ue,a as re}from"./VWindowItem.497ecbdb.js";import{V as F}from"./VRow.f081c54f.js";import{V as f}from"./VCol.56e6ffca.js";import{V as de}from"./VDataTable.d1ba4617.js";import{V as ne}from"./VContainer.756d32e1.js";import{V as ie}from"./VTextarea.638ea425.js";import{V as me}from"./VDialog.b6443236.js";import{V as pe}from"./VAlert.d510c814.js";import{V as ce}from"./VSnackbar.b9c88be7.js";import"./VCheckboxBtn.7df7b8f0.js";import"./forwardRefs.6ea3df5c.js";import"./VSelect.ce97ab09.js";import"./VMenu.2e511fd8.js";import"./createSimpleFunctional.4495d00f.js";import"./VAvatar.2a21003b.js";import"./VDivider.d1296279.js";/* empty css              */const fe={class:"text-center"},He=q({__name:"approval",setup(ve){const A=G(),v=ae();v.loadEmpCode(),console.log("í˜„ìž¬ ë¡œê·¸ì¸ëœ ì§ì› ì½”ë“œ:",v.empCode),v.empCode!=="EMP-0001"&&A.push("/hr/confinement/unauthorized");const V=s("personal-info"),_=s("");s("");const T=s([]),w=s(""),L=s([]),C=s(""),b=s(""),u=s([]),h=s(""),m=s(!1),x=s(""),g=s([]),N=s(!1),S=s("success"),U=s("success"),j=s("ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."),D=s([]),M=[{title:"êµìœ¡ì½”ë“œ",key:"eduCode",width:120},{title:"êµìœ¡ëª…",key:"eduName",width:"150px"},{title:"ì§ì›ì½”ë“œ",key:"empCode",width:120},{title:"ì§ì›ëª…",key:"empName",width:100},{title:"ë¶€ì„œì½”ë“œ",key:"deptCode",width:120},{title:"ë¶€ì„œëª…",key:"deptName",width:100},{title:"êµìœ¡ ì´ìˆ˜ ë‚´ì—­",key:"eduHistory",width:"150px"},{title:"ìŠ¹ì¸ìƒíƒœ",key:"status",width:120},{title:"ê²€ìƒ‰ë…„ë„",key:"searchYear",width:"150px"},{title:"ë°˜ë ¤ì‚¬ìœ ",key:"rejectCause",witdh:"300px"},{title:"ë¹„ê³ ",key:"etc",width:"300px"},{title:"ì¦ëª…ì„œêµ¬ë¶„",key:"category",witdh:120}];J(()=>{B(),P()});const B=async()=>{await $().FETCH_DEPTLIST(),L.value=Object.values($().deptList).map(o=>({title:o.deptName,value:o.deptName}))},P=async()=>{await R().FETCH_ALL_EMP(),T.value=Object.values(R().all_emp_list).map(o=>({title:o.empName,value:o.empCode}))},y=async()=>{if(w.value===""||C.value===""||b.value===""||_.value===""){alert("ëª¨ë“  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}await p.get("http://localhost:8282/hr/edu/findEduList",{params:{startDate:C.value,endDate:b.value,empCode:_.value,deptName:w.value}}).then(o=>{D.value=o.data.eduList,console.log("eduList",D.value)}).catch(o=>console.error(o))},W=async o=>{if(v.empCode!=="EMP-0001"){S.value="error",j.value="â›” ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ìžì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.",U.value="error",N.value=!0;return}if(u.value.length===0){alert("í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}if(o==="ìŠ¹ì¸"&&u.value[0].status==="ìŠ¹ì¸"){alert("ì´ë¯¸ ìŠ¹ì¸ëœ ê±´ìž…ë‹ˆë‹¤.");return}const t=o==="ìŠ¹ì¸"?"approval":"cancel",n=o==="ìŠ¹ì¸"?"ìŠ¹ì¸ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.":"ìŠ¹ì¸ ì·¨ì†Œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",d=u.value.map(l=>({...l,status:t}));console.log("updatedRows",d);try{await p.post("http://localhost:8282/hr/edu/approEduList",d),alert(n)}catch(l){console.error(l)}u.value=[],y()},H=()=>{var o;if(u.value.length===0){alert("í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}if(((o=u.value[0])==null?void 0:o.status)==="ìŠ¹ì¸"){alert("ìŠ¹ì¸ëœ ê±´ì€ ë°˜ë ¤í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),u.value=[];return}m.value=!0},I=async()=>{var o;h.value=(o=u.value[0])==null?void 0:o.eduCode,console.log(h.value),await p.patch(`http://localhost:8282/hr/edu/updateUseDate/${h.value}`).then(t=>{console.log("updateUseDate",t.data)}).catch(t=>console.error(t)),await p.get("http://localhost:8282/hr/edu/printEduCertificate",{params:{eduCode:h.value}}).then(t=>{g.value=t.data.printCertificate,console.log("printCertificate.value",g.value),console.log("selectedRows.value",u.value);const n=E.json_to_sheet([g.value]);console.log("certWS",n);const d=E.book_new();E.book_append_sheet(d,n,"certificate"),te(d,`${new Date}_${u.value[0].eduName}_${u.value[0].empName}_${u.value[0].etc}.xlsx`)}).catch(t=>console.error(t)),u.value=[],y()},O=async()=>{const o=u.value.map(t=>({...t,status:"refer",rejectCause:x.value}));console.log("updatedRows",o),await p.post("http://localhost:8282/hr/edu/approEduList",o),m.value=!1,alert("ìŠ¹ì¸ ë°˜ë ¤ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. "),u.value=[],y()};return(o,t)=>{const n=z,d=Y;return K(),Q(ee,null,[e(c,null,{default:a(()=>[e(le,{modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=l=>V.value=l),height:"70"},{default:a(()=>[e(oe,{value:"personal-info"},{default:a(()=>[r(" ðŸ“‹ êµìœ¡ ìŠ¹ì¸ ë° ë°˜ë ¤ ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(c,{flat:""},{default:a(()=>[e(k,null,{default:a(()=>[e(ue,{modelValue:V.value,"onUpdate:modelValue":t[5]||(t[5]=l=>V.value=l),class:"disable-tab-transition"},{default:a(()=>[e(re,{value:"personal-info"},{default:a(()=>[e(c,{class:"mb-6"},{default:a(()=>[e(k,null,{default:a(()=>[e(F,null,{default:a(()=>[e(f,{cols:"12",sm:"2"},{default:a(()=>[e(n,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=l=>_.value=l),label:"ì§ì›ëª…",items:T.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"12",sm:"2"},{default:a(()=>[e(n,{modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=l=>w.value=l),label:"ë¶€ì„œëª…",items:L.value,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"12",sm:"3",mt:"4"},{default:a(()=>[e(d,{modelValue:C.value,"onUpdate:modelValue":t[3]||(t[3]=l=>C.value=l),type:"date",label:"ì‹œìž‘ì¼",placeholder:"ì‹œìž‘ì¼"},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",sm:"3",mt:"4"},{default:a(()=>[e(d,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=l=>b.value=l),type:"date",label:"ì¢…ë£Œì¼",placeholder:"ì¢…ë£Œì¼"},null,8,["modelValue"])]),_:1}),e(i,{class:"mt-10",onClick:y},{default:a(()=>[r(" ì¡°íšŒ ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(c,{class:"mt-6"},{default:a(()=>[e(k,{class:"mt-3 mb-3"},{default:a(()=>[r(" ì¦ëª…ì„œìŠ¹ì¸ë‚´ì—­ ")]),_:1}),e(X(de),{modelValue:u.value,"onUpdate:modelValue":t[6]||(t[6]=l=>u.value=l),headers:M,items:D.value,"items-per-page":10,"show-select":"","return-object":"","item-value":"certificateNo"},null,8,["modelValue","items"]),e(F,{class:"text-right mr-3 mb-2 mt-3"},{default:a(()=>[e(f,null,{default:a(()=>[e(i,{class:"mr-2",color:"primary",onClick:t[7]||(t[7]=l=>W("ìŠ¹ì¸"))},{default:a(()=>[r(" ìŠ¹ì¸ ")]),_:1}),e(i,{color:"primary",class:"mr-2",onClick:H},{default:a(()=>[r(" ìŠ¹ì¸ë°˜ë ¤ ")]),_:1}),e(i,{color:"primary",onClick:I},{default:a(()=>[r(" ì¶œë ¥ ")]),_:1})]),_:1})]),_:1})]),_:1}),Z("div",fe,[e(me,{modelValue:m.value,"onUpdate:modelValue":t[10]||(t[10]=l=>m.value=l),width:"300"},{default:a(()=>[e(c,null,{default:a(()=>[e(k,null,{default:a(()=>[r(" ë°˜ë ¤ì‚¬ìœ ë¥¼ ìž…ë ¥í•´ì£¼ì„¸ìš”. ")]),_:1}),e(ne,null,{default:a(()=>[e(ie,{modelValue:x.value,"onUpdate:modelValue":t[8]||(t[8]=l=>x.value=l),clearable:"",label:"ë°˜ë ¤ì‚¬ìœ ",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(se,null,{default:a(()=>[e(i,{color:"primary",onClick:O},{default:a(()=>[r(" ë°˜ë ¤ ")]),_:1}),e(i,{color:"primary",onClick:t[9]||(t[9]=l=>m.value=!1)},{default:a(()=>[r(" ë‹«ê¸° ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(ce,{modelValue:N.value,"onUpdate:modelValue":t[11]||(t[11]=l=>N.value=l),location:"top",timeout:3e3,color:S.value},{default:a(()=>[e(pe,{density:"compact",type:U.value,title:"ì•Œë¦¼",text:j.value},null,8,["type","text"])]),_:1},8,["modelValue","color"])],64)}}});export{He as default};
