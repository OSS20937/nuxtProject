import{_ as P}from"./DialogCloseBtn.vue.0176b975.js";import{_ as z}from"./AppSelect.vue.71d8fb80.js";import{_ as A}from"./AppTextField.vue.34aba9d8.js";import{b as n}from"./index.b2f92b84.js";import{a as v,b as w}from"./VCard.1ce8b0ac.js";import{V as I}from"./VRow.4e9f5ddb.js";import{V as g}from"./VCol.fa6809e5.js";import{V as F}from"./VDataTable.320c8fba.js";import{a as O,l as K,b as h,m as U,g as B,e,w as a,f as s,i as y,j as C,F as R,k as q,r as f,C as J,D as Q,s as k,E as X}from"./entry.e158bc8e.js";import{V as W}from"./VDialog.b7ac1948.js";import{a as $}from"./index.08781b93.js";import{u as Z}from"./emp.69aa027f.js";import{V as ee,a as te}from"./VTabs.ae94f9d8.js";import{V as ae,a as oe}from"./VWindowItem.476eb551.js";import"./VCheckboxBtn.7676e3d1.js";import"./forwardRefs.6ea3df5c.js";import"./VSelect.72dddcc6.js";import"./VMenu.dc4f7cef.js";import"./createSimpleFunctional.916b6f3e.js";import"./VAvatar.8c980a86.js";import"./VDivider.6873478d.js";/* empty css              */const le={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},se=O({__name:"deptModal",props:["fetchData"],setup(b){const N=b,_=[{title:"사원코드",key:"empCode"},{title:"사원명",key:"empName"},{title:"고용일",key:"hireDate"},{title:"직급",key:"positionName"}],p=K(()=>n().deptRow),i=async()=>{const m={deptName:p.value.deptName,deptCode:p.value.deptCode,workplaceCode:p.value.workplaceCode};console.log(m),await n().MODIFY_DEPT(m),await N.fetchData(),n().SET_DIALOG(!1)},T=async()=>{try{const m={deptCode:p.value.deptCode,workplaceCode:p.value.workplaceCode};console.log(m),await n().REMOVE_DEPT(m),await N.fetchData(),n().SET_DIALOG(!1)}catch(m){console.error(m),alert("부서 삭제 중 오류가 발생했습니다.")}};return(m,d)=>{const u=P,V=A;return h(),U(R,null,[B("div",le,[e(W,{modelValue:s(n)().isDialog,"onUpdate:modelValue":d[3]||(d[3]=c=>s(n)().isDialog=c),"max-width":"600"},{default:a(()=>[e(u,{onClick:d[0]||(d[0]=c=>s(n)().SET_DIALOG(!1))}),e(v,{title:"부서정보"},{default:a(()=>[e(w,null,{default:a(()=>[e(I,null,{default:a(()=>[e(g,{cols:"12",sm:"6"},{default:a(()=>[e(V,{modelValue:s(p).deptCode,"onUpdate:modelValue":d[1]||(d[1]=c=>s(p).deptCode=c),label:"부서 코드",disabled:""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:a(()=>[e(V,{modelValue:s(p).deptName,"onUpdate:modelValue":d[2]||(d[2]=c=>s(p).deptName=c),label:"부서명"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s(F),{headers:_,items:s(p).empList},null,8,["items"]),e(w,{class:"d-flex justify-end flex-wrap gap-3 mt-2"},{default:a(()=>[e(y,{onClick:i},{default:a(()=>[C(" 수정 ")]),_:1}),e(y,{onClick:T},{default:a(()=>[C(" 삭제 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),e(v)],64)}}}),de=B("h1",{class:"mb-6"}," 부서정보관리 ",-1),Le=O({__name:"deptManage",setup(b){const N=q(),_=Z();_.loadEmpCode(),console.log("현재 로그인된 직원 코드:",_.empCode),_.empCode!=="EMP-01"&&_.empCode!=="EMP-00"&&N.push("/hr/confinement/unauthorized");const p=f([]),i=f(!1),T=f([]),m=f(""),d=f("personal-info"),u=f(""),V=f(""),c=()=>{const o=new Date;let t=o.getMonth()+1,r=o.getDate();t.toString().length===1&&(t=`0${t}`),r.toString().length===1&&(r=`0${r}`),V.value=`${o.getFullYear()}-${t}-${r}`},E=async()=>{try{await n().FIND_DEPT_MANAGE_LIST(),p.value=[...n().deptManageList]}catch(o){console.error("데이터 불러오기 중 에러:",o)}},G=[{title:"사업자명",key:"workplaceName"},{title:"부서코드",key:"deptCode"},{title:"부서명",key:"deptName"},{title:"책임자",key:"head"},{title:"부서인원",key:"count"},{title:"부서시작일",key:"deptStartDate"}],j=async()=>{await n().FETCH_WORKPLACELIST();const o=n().workplaceList||{};T.value=Object.values(o).map(t=>({title:t.workplaceName,value:{deptCode:t.workplaceCode,deptName:t.workplaceName}}))},H=async()=>{console.log(u.value.deptName),console.log(m.value);let o="0";const t=p.value;console.log(t);for(let D=0;D<t.length;D++){const l=t[D].deptCode.split("-")[1];l>o&&(o=l)}const r=`DPT-${++o}`;console.log(r);const S={deptCode:r,deptName:m.value,workplaceCode:u.value.deptCode,workplaceName:u.value.deptName,companyCode:null,deptStartDate:V.value};await n().ADD_DEPT(S),await E(),i.value=!1},Y=async o=>{await $().FETCH_DEPT_EMP_LIST(o.item.deptCode);const t={deptCode:o.item.deptCode,deptName:o.item.deptName,workplaceCode:o.item.workplaceCode,count:o.item.count,empList:$().selected_dept_Emp_List};n().SET_DEPT_ROW(t),n().SET_DIALOG(!0)};return J(()=>{E(),j(),c()}),(o,t)=>{const r=P,S=z,D=A,L=Q("MonthTap"),x=se;return h(),U(R,null,[de,e(v,null,{default:a(()=>[e(ee,{modelValue:s(d),"onUpdate:modelValue":t[0]||(t[0]=l=>k(d)?d.value=l:null),height:"70"},{default:a(()=>[e(te,{value:"personal-info"},{default:a(()=>[C(" 부서정보관리 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(v,{flat:""},{default:a(()=>[e(w,null,{default:a(()=>[e(ae,{modelValue:s(d),"onUpdate:modelValue":t[7]||(t[7]=l=>k(d)?d.value=l:null),class:"disable-tab-transition"},{default:a(()=>[e(oe,{value:"personal-info"},{default:a(()=>[e(W,{modelValue:s(i),"onUpdate:modelValue":t[6]||(t[6]=l=>k(i)?i.value=l:null),"max-width":"600"},{activator:a(({props:l})=>[e(g,{cols:"12",md:"2","offset-md":"10"},{default:a(()=>[e(y,X(l,{class:"ml-md-2",onClick:t[1]||(t[1]=M=>i.value=!0)}),{default:a(()=>[C(" 부서추가 ")]),_:2},1040)]),_:2},1024)]),default:a(()=>[e(r,{onClick:t[2]||(t[2]=l=>i.value=!1)}),e(v,{title:"부서추가"},{default:a(()=>[e(w,null,{default:a(()=>[e(I,null,{default:a(()=>[e(g,{cols:"12",sm:"6"},{default:a(()=>[e(S,{modelValue:s(u),"onUpdate:modelValue":t[3]||(t[3]=l=>k(u)?u.value=l:null),items:s(T),label:"등록할 부서명의 사업장을 선택해주세요"},null,8,["modelValue","items"])]),_:1}),e(g,{cols:"12",sm:"6"},{default:a(()=>[e(D,{modelValue:s(m),"onUpdate:modelValue":t[4]||(t[4]=l=>k(m)?m.value=l:null),label:"등록할 부서명을 입력해주세요",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(w,{class:"d-flex justify-end flex-wrap gap-3"},{default:a(()=>[e(y,{variant:"tonal",color:"secondary",onClick:t[5]||(t[5]=l=>i.value=!1)},{default:a(()=>[C(" Close ")]),_:1}),e(y,{onClick:H},{default:a(()=>[C(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(L)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s(F),{headers:G,items:s(p),"items-per-page":5,"onClick:row":t[8]||(t[8]=(l,M)=>Y(M))},null,8,["items"]),e(x,{"fetch-data":E})],64)}}});export{Le as default};
