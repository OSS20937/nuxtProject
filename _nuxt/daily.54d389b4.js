import{_ as Ne}from"./AppDateTimePicker.vue.ad1ee397.js";import{_ as we}from"./DialogCloseBtn.vue.58d82a85.js";import{a as ee,c as ve,V as fe,b as ye}from"./VCard.f486dae6.js";import{V as Ee}from"./VSpacer.e72775f0.js";import{V as P}from"./VSelect.df16466a.js";import{V as H}from"./VCheckboxBtn.bbe7695b.js";import{a as re,r as o,x as j,b as F,c as W,w as a,e as l,j as _,i as E,g as z,t as Ve,f as d,y as ke,o as Le,k as Ue,p as ce,m as Pe,z as Me,s as h,A as ie,F as $e,B as $}from"./entry.65ada128.js";import{V as me}from"./VDialog.93a74892.js";import{a as X}from"./index.160c8af3.js";import{V as Z}from"./VContainer.ab27e81f.js";import{V as k}from"./VRow.55c98ddb.js";import{V as r}from"./VCol.643afbff.js";import{u as Ie}from"./emp.21d975f6.js";import{V as Oe}from"./VForm.c789c271.js";import{V as Re}from"./VDataTable.40f54bb6.js";import"./createSimpleFunctional.89702091.js";import"./VAvatar.657122ee.js";import"./forwardRefs.6ea3df5c.js";import"./VMenu.85549b48.js";import"./VDivider.dabdf568.js";/* empty css              */const Be=re({__name:"empSearchModal",props:{modelValue:{type:Boolean},empOptions:{}},emits:["update:modelValue","searchEmp"],setup(J,{emit:I}){const C=J,D=o(!1),A=o(""),y=o("");j(()=>C.modelValue,c=>{D.value=c}),j(D,c=>{I("update:modelValue",c)}),j(A,c=>{const f=C.empOptions.find(n=>n.empCode===c);y.value=(f==null?void 0:f.empName)??""});const S=()=>{I("searchEmp",A.value),D.value=!1};return(c,f)=>(F(),W(me,{modelValue:D.value,"onUpdate:modelValue":f[2]||(f[2]=n=>D.value=n),"max-width":"600"},{default:a(()=>[l(ee,null,{default:a(()=>[l(ve,null,{default:a(()=>[_("사번으로 검색")]),_:1}),l(fe,null,{default:a(()=>[l(Ee),l(P,{modelValue:A.value,"onUpdate:modelValue":f[0]||(f[0]=n=>A.value=n),items:C.empOptions,"item-title":"empCode","item-value":"empCode",label:"사번 선택",variant:"outlined",style:{width:"70px"}},null,8,["modelValue","items"]),l(H,{modelValue:y.value,"onUpdate:modelValue":f[1]||(f[1]=n=>y.value=n),variant:"outlined",readonly:"",label:"사원 이름",style:{width:"70px"}},null,8,["modelValue"]),l(E,{onClick:S},{default:a(()=>[_("조회")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Fe=z("span",{class:"text-h6 font-weight-bold"},"일근태 추가",-1),He={class:"text-subtitle-2 text-medium-emphasis mt-1"},je=re({__name:"addAttenModal",props:{depList:{},applyDay:{}},emits:["submitAttendData"],setup(J,{emit:I}){const C=J,D=o(""),A=ke(),y=o(""),S=o("사원명을 선택하세요"),c=o("사원명을 선택하세요"),f=o(""),n=o(),b=o("부서 선택"),N=o(!0),Y=o(!0),Q=o(!0),w=o(!0),L=o(),U=["출근","퇴근","공외출","공귀사","외출(무단)","귀사(무단)"],T=o([{empCode:"",empName:"부서를 먼저 선택하세요"}]),le=Array.from({length:24},(v,s)=>s.toString().padStart(2,"0")),te=async v=>{console.log("선택된 부서코드:",v),await X().FETCH_EMP_DEPT_IN(v),X().employeesInDeptList.length===0?(Q.value=!0,T.value=[{empCode:"",empName:"해당 부서에 직원이 없습니다."}]):(Q.value=!1,T.value=[{empCode:"",empName:"사원을 선택하세요"},...X().employeesInDeptList]),console.log("employeesInDept: ",T.value)},ae=()=>{S.value=y.value;const v=T.value.find(s=>s.empCode===y.value);D.value=(v==null?void 0:v.empName)??"",N.value=!1,c.value="근태 유형"},O=()=>{Y.value=!1},g=v=>{const s=Number(v);return!v||/^\d{1,2}$/.test(v)&&s>=0&&s<=59?!0:"0~59 사이 숫자를 입력하세요."},V=()=>{n.value<=59&&n.value>=0?w.value=!1:w.value=!0},m=()=>{console.log("추가 버튼 클릭됨");const v=String(f.value).padStart(2,"0")+String(n.value).padStart(2,"0");let s;const u=C.depList.find(oe=>oe.deptCode===b.value);s=(u==null?void 0:u.deptName)??"",console.log("찾은 부서 이름:",s),console.log(v),L.value={empName:D.value,empCode:S.value,attdTypeName:c.value,time:v,deptName:s,applyDay:C.applyDay,dayAttdCode:"아직 반영되지 않음"};const R={...L.value};console.log("추가된 데이터 객체:",L.value),console.log("payload:",R),I("submitAttendData",R)};return(v,s)=>(F(),W(me,{modelValue:A.value,"onUpdate:modelValue":s[6]||(s[6]=u=>A.value=u),"max-width":"600"},{default:a(()=>[l(ee,null,{default:a(()=>[l(ve,{class:"d-flex flex-column align-start px-4 pt-6"},{default:a(()=>[Fe,z("span",He," 일자: "+Ve(C.applyDay),1)]),_:1}),l(ye,null,{default:a(()=>[l(Z,null,{default:a(()=>[l(k,null,{default:a(()=>[l(r,{cols:"5"},{default:a(()=>[l(P,{modelValue:b.value,"onUpdate:modelValue":[s[0]||(s[0]=u=>b.value=u),te],items:C.depList,"item-title":"deptName","item-value":"deptCode",label:"부서 선택",variant:"outlined",clearable:"",style:{width:"250px"}},null,8,["modelValue","items"])]),_:1})]),_:1}),l(k,null,{default:a(()=>[l(r,{cols:"6"},{default:a(()=>[l(P,{modelValue:y.value,"onUpdate:modelValue":[s[1]||(s[1]=u=>y.value=u),ae],items:T.value,"item-title":"empName","item-value":"empCode",label:"사원명 선택",variant:"outlined",disabled:Q.value},null,8,["modelValue","items","disabled"])]),_:1}),l(r,{cols:"6"},{default:a(()=>[l(H,{label:"사원코드",modelValue:S.value,"onUpdate:modelValue":s[2]||(s[2]=u=>S.value=u),variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),l(k,null,{default:a(()=>[l(r,{cols:"6"},{default:a(()=>[l(P,{label:"근태 유형",items:U,modelValue:c.value,"onUpdate:modelValue":[s[3]||(s[3]=u=>c.value=u),O],variant:"outlined",clearable:"",disabled:N.value},null,8,["modelValue","disabled"])]),_:1}),l(r,{cols:"3"},{default:a(()=>[l(P,{label:"시",items:d(le),modelValue:f.value,"onUpdate:modelValue":s[4]||(s[4]=u=>f.value=u),variant:"outlined",disabled:Y.value},null,8,["items","modelValue","disabled"])]),_:1}),l(r,{cols:"3"},{default:a(()=>[l(H,{label:"분(0~59)",modelValue:n.value,"onUpdate:modelValue":[s[5]||(s[5]=u=>n.value=u),V],variant:"outlined",maxlength:"2",rules:[g],disabled:Y.value},null,8,["modelValue","rules","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l(fe,{class:"justify-end"},{default:a(()=>[l(E,{color:"primary",variant:"elevated",size:"large",class:"font-weight-bold text-white px-4 py-1",onClick:m,disabled:w.value},{default:a(()=>[_(" 기록 추가 ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ze=z("h1",{class:"mb-6"},"일근태 등록",-1),Ye=z("h1",null,"   일근태 기록",-1),Qe=z("span",null,"표시할 행 수:",-1),vl=re({__name:"daily",setup(J){const I=t=>{console.log("부모가 받은 데이터:",t);const e=n.value.length+1;c.value=!1;const p={...t,rowNumber:e};n.value.push(p)},C=()=>{c.value=!0,S.value=[...y.value]},D=t=>{const e=t.toString().padStart(4,"0");return`${e.slice(0,2)}:${e.slice(2)}`},A=()=>{n.value=n.value.map(t=>{const e=y.value.find(p=>p.deptCode===t.deptCode);return{...t,deptName:e?e.deptName:t.deptCode}})},y=o([]),S=o([]),c=o(!1),f=async()=>{try{await X().FETCH_ALL_DEPARTMENT(),y.value=X().all_dept_list,console.log("depList",y.value)}catch(t){console.error(t)}};Le(()=>{De(),f()});const n=o([]),b=o(""),N=o(""),Y=Array.from({length:24},(t,e)=>e.toString().padStart(2,"0")),Q=t=>{const e=Number(t);return!t||/^\d{1,2}$/.test(t)&&e>=0&&e<=59?!0:"0~59 사이 숫자를 입력하세요"};j([b,N],()=>{if(b.value&&N.value){const t=b.value.padStart(2,"0"),e=N.value.padStart(2,"0");R.value=`${t}${e}`,console.log(R.value)}});const w=o(10),L=o(""),U=o([]),T=o(""),le=async()=>{if(!m.value){alert("날짜를 선택해주세요.");return}try{T.value=m.value;const t={applyDay:T.value,pageSize:w.value};if(console.log("dayAndPage",t),await $().SEARCH_DAY_ATTD_LIST(t),U.value=$().dayAttdDayleList,console.log("attendDaliyList.value",U.value),n.value=U.value.map((e,p)=>({...e,rowNumber:p+1})),A(),console.log("dayAttdList: ",n.value),U.value.length>0){const e=U.value[U.value.length-1];L.value=e.dayAttdCode,console.log("lastCode 업데이트:",L.value)}}catch(t){console.error("일근태 조회 실패:",t)}},te=async()=>{if(T.value!=m.value){alert("일근태 조회를 먼저 누르십시오.");return}if(m.value==""){alert("일근태 조회를 먼저 하십시오.");return}const t={applyDay:T.value,pageSize:w.value,lastCode:L.value};console.log("nextPageQueryString: ",t);try{await $().SEARCH_DAY_ATTD_NEXT_PAGE_LIST(t);const e=$().dayAttdDayleNextPageList;if(e.length===0){alert("마지막 검색입니다.");return}const p=n.value.length,G=e.map((ne,de)=>({...ne,rowNumber:p+de+1}));n.value.push(...G),A(),L.value=e[e.length-1].dayAttdCode}catch(e){console.error("다음 검색 실패:",e)}},ae=Ue(),O=Ie();O.loadEmpCode(),console.log("현재 로그인된 직원 코드:",O.empCode),O.empCode!=="EMP-01"&&O.empCode!=="EMP-00"&&ae.push("/hr/confinement/unauthorized");const g=o(!1),V=o(!1);o(!1);const m=o(""),v=o(""),s=o([]),u=o("");o([]);const R=o(""),oe=o([]),B=o(""),x=o("");o({});const M=o("insert"),ge=o(""),q=o(""),_e=[{title:"번호",key:"rowNumber"},{title:"부서",key:"deptName"},{title:"사원번호",key:"empCode"},{title:"이름",key:"empName"},{title:"승인날짜",key:"applyDay"},{title:"근태내용",key:"attdTypeName"},{title:"시간",key:"time"},{title:"전체기록번호",key:"dayAttdCode"}],pe=[{text:"출근",value:"ADC001"},{text:"퇴근",value:"ADC002"},{text:"공외출",value:"ADC003"},{text:"공귀사",value:"ADC007"},{text:"귀사(무단)",value:"ADC010"},{text:"외출(무단)",value:"ADC012"}],Ce=t=>({title:t.text,value:t.value});j(x,(t,e)=>{const p=pe.find(G=>G.value===t);p&&(B.value=p.text,x.value=p.value,console.log("Selected Title:",B.value),console.log("Selected value:",x.value))}),j(v,(t,e)=>{t!==e&&fetchEmpList()});const De=async()=>{try{const e=(await ce.get("http://localhost:8282/hr/base/deptList")).data.deptlist;s.value=e.map(p=>({value:p.deptCode,text:p.deptName})),console.log("[deptList]",s.value)}catch(t){console.error(t)}},Ae=t=>{console.log("자식으로부터 받은 사번:",t),n.value=n.value.filter(e=>e.empCode===t)},K=o(!1),ue=o([]),be=()=>{K.value=!0;const t=new Set;ue.value=n.value.filter(e=>t.has(e.empCode)?!1:(t.add(e.empCode),!0)).map(e=>({empCode:e.empCode,empName:e.empName})),console.log(ue.value)},se=async()=>{if(m.value==="")alert("조회할 신청일자를 선택해주세요."),g.value=!g.value;else try{console.log("[applyDay]",m.value),console.log("[empCode]",u.value);const t=await ce.get("http://localhost:8282/hr/attendance/dayAttendance",{params:{applyDay:m.value,empCode:u.value}});console.log("[day_attd_list.value]",t.data.dayAttdList),oe.value=t.data.dayAttdList,g.value=!1}catch(t){console.error(t)}},Te=async()=>{if(m.value==="")alert("조회할 신청일자를 선택해주세요."),g.value=!g.value;else try{const t={empCode:u.value,applyDay:m.value,attdTypeCode:x.value,attdTypeName:B.value,time:R.value};Object.values(t).some(e=>e=="")?alert("모든 항목을 선택해주세요."):(await $().ADD_DAY_ATTD_BY_PARMS(t),alert("신청이 완료되었습니다. "),se(),V.value=!1)}catch(t){console.error(t)}},xe=async()=>{console.log("selectedAttdTypeValue.value",x.value),console.log("selectedAttdTypeText.value",B.value),console.log("selectedEmp.value",u.value),console.log("targetDayAttdCode",q.value),m.value===""?(alert("조회할 신청일자를 선택해주세요."),g.value=!g.value):B.value===""||x.value===""?alert("근태 유형을 선택해주세요."):(await $().UPDATE_DAYATTD({attdTypeCode:x.value,attdTypeName:B.value,empCode:u.value,dayAttdCode:q.value}).then(t=>{console.log("[수정완료]",t.data),alert("수정이 완료되었습니다."),se()}).catch(t=>console.error(t)),V.value=!1,M.value="insert")},he=()=>{if(console.log("삭제"),console.log("selectedEmp.value",u.value),console.log("targetDayAttdCode",q.value),m.value==="")alert("조회할 신청일자를 선택해주세요."),g.value=!g.value;else{const t={empCode:u.value,dayAttdCode:q.value};$().DELETE_DAT_ATTD(t).then(e=>{console.log("[삭제결과]",e.data),V.value=!1,M.value="insert",alert("삭제가 완료되었습니다."),se()}).catch(e=>console.error(e))}},Se=async(t,e)=>{try{console.log("[clickRow]",e),ge.value=e.item.time,q.value=e.item.dayAttdCode,console.log("[targetTime]",e.item.time),M.value="update",V.value=!0,console.log(V.value)}catch(p){console.error(p)}};return(t,e)=>{const p=Ne,G=we,ne=Be,de=je;return F(),Pe($e,null,[ze,z("div",null,[l(ee,null,{default:a(()=>[l(Z,{class:"mt-4"},{default:a(()=>[l(Oe,{onSubmit:Me(()=>{},["prevent"])},{default:a(()=>[l(k,{align:"center",justify:"end",class:"mb-2"},{default:a(()=>[l(r,null,{default:a(()=>[Ye]),_:1}),l(r,{md:"2"},{default:a(()=>[l(p,{modelValue:d(m),"onUpdate:modelValue":e[0]||(e[0]=i=>h(m)?m.value=i:null),placeholder:"날짜선택","prepend-icon":"tabler-calendar-event"},null,8,["modelValue"])]),_:1}),l(r,{cols:"auto"},{default:a(()=>[l(E,{color:"primary",onClick:le,class:"text-white","prepend-icon":"tabler-calendar-search",style:{"min-width":"120px"}},{default:a(()=>[_(" 일근태 조회 ")]),_:1})]),_:1}),l(r,{cols:"auto"},{default:a(()=>[l(E,{style:{"min-width":"120px"},onClick:be,disabled:d(n).length===0},{default:a(()=>[_(" 사번조회 ")]),_:1},8,["disabled"])]),_:1}),l(r,{cols:"auto",class:"me-2"},{default:a(()=>[l(me,{modelValue:d(V),"onUpdate:modelValue":e[7]||(e[7]=i=>h(V)?V.value=i:null),width:"500"},{activator:a(({props:i})=>[l(E,{onClick:C,disabled:d(m)===""},{default:a(()=>[_(" 일근태 기록 추가 ")]),_:1},8,["disabled"])]),default:a(()=>[l(Z,null,{default:a(()=>[l(G,{onClick:e[1]||(e[1]=i=>V.value=!d(V))})]),_:1}),l(ee,{title:`${d(M)==="insert"?"일근태 추가":"일근태 수정/삭제"}`},{default:a(()=>[l(Z,null,{default:a(()=>[l(k,null,{default:a(()=>[l(r,null,{default:a(()=>[l(H,{modelValue:d(u),"onUpdate:modelValue":e[2]||(e[2]=i=>h(u)?u.value=i:null),class:"mb-3",label:"사원명",readonly:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(r,null,{default:a(()=>[l(H,{modelValue:d(u),"onUpdate:modelValue":e[3]||(e[3]=i=>h(u)?u.value=i:null),class:"mb-3",label:"사원코드",readonly:"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),l(k,null,{default:a(()=>[l(r,null,{default:a(()=>[l(P,{modelValue:d(x),"onUpdate:modelValue":e[4]||(e[4]=i=>h(x)?x.value=i:null),class:"mb-3",label:"근무타입",items:pe,"item-props":Ce,variant:"outlined",clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1}),l(r,null,{default:a(()=>[l(k,null,{default:a(()=>[l(r,{cols:"6"},{default:a(()=>[l(P,{modelValue:d(b),"onUpdate:modelValue":e[5]||(e[5]=i=>h(b)?b.value=i:null),items:d(Y),label:"시",variant:"outlined",dense:"",clearable:"",style:{"min-width":"120px"}},null,8,["modelValue","items"])]),_:1}),l(r,{cols:"6"},{default:a(()=>[l(H,{modelValue:d(N),"onUpdate:modelValue":e[6]||(e[6]=i=>h(N)?N.value=i:null),label:"분",variant:"outlined",dense:"",rules:[Q],maxlength:"2"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ye,{class:"d-flex justify-end"},{default:a(()=>[d(M)==="insert"?(F(),W(E,{key:0,onClick:Te},{default:a(()=>[_(" 추가 ")]),_:1})):ie("",!0),d(M)==="update"?(F(),W(E,{key:1,onClick:xe},{default:a(()=>[_(" 수정 ")]),_:1})):ie("",!0),d(M)==="update"?(F(),W(E,{key:2,class:"ml-3",onClick:he},{default:a(()=>[_(" 삭제 ")]),_:1})):ie("",!0)]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"]),l(k,null,{default:a(()=>[l(d(Re),{class:"mt-6",headers:_e,items:d(n),"items-per-page":100,"onClick:row":Se,"hide-default-footer":""},{"item.time":a(({item:i})=>[_(Ve(D(i.time)),1)]),_:1},8,["items"])]),_:1}),l(k,{align:"center",class:"mt-2"},{default:a(()=>[l(r,{cols:"auto"},{default:a(()=>[Qe]),_:1}),l(r,{cols:"3"},{default:a(()=>[l(P,{modelValue:d(w),"onUpdate:modelValue":e[8]||(e[8]=i=>h(w)?w.value=i:null),items:[10,50,100],label:"행 수 선택",variant:"outlined",dense:""},null,8,["modelValue"])]),_:1}),l(r,{cols:"auto"},{default:a(()=>[l(E,{color:"primary",class:"text-white",onClick:te},{default:a(()=>[_(" 다음 검색 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ne,{modelValue:d(K),"onUpdate:modelValue":e[9]||(e[9]=i=>h(K)?K.value=i:null),empOptions:d(ue),onSearchEmp:Ae},null,8,["modelValue","empOptions"]),l(de,{modelValue:d(c),"onUpdate:modelValue":e[10]||(e[10]=i=>h(c)?c.value=i:null),depList:d(S),applyDay:d(m),onSubmitAttendData:I},null,8,["modelValue","depList","applyDay"])])],64)}}});export{vl as default};
